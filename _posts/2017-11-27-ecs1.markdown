---
layout:     post
title:      "阿里云ECS折腾日记1"
subtitle:   " \"购买ECS、绑定域名、安装vsftp、jdk\""
date:       2017-11-27 22:34:00
author:     "huangyang"
header-img: "img/post-bg-2015.jpg"
tags:
    - 阿里云
---
# 起因
这些年，断断续续买过几次ECS服务，没有超过3个月的，一是心疼大洋，二是没啥想在ECS上折腾的。平时需要ECS，需要绑定域名的时候，就用公司的ECS玩玩。前两天又貌似突然想通了，为啥要这么凑合呢？买一个吧，便宜的。花了钱，也许反过头来就能促进自己去做点什么了，一边折腾一边学习了。折腾的过程就一点一定记录下来，这是第一篇。

# 购买经过
购买过程非常方便，也算是轻车熟路了。手机上操作很方便，不到10分钟，330+55+9=394块大洋扔出去，分别得到了ECS入门型1年，域名1个，云解析1年。好吧，花钱的过程还是挺享受的。为了上述这小400大洋，接下来一年我也要好好折腾。

![输入图片说明]({{ site.baseurl }}/img/in-post/2017-11-27-ecs1-225847_8a7c9644_58701.jpeg "1.jpg")

# 目标
每次一个小的折腾目标吧，今天的目标就是初始化ECS，安装vsftp和jdk。

# 经过
## ECS实例确认
PC上登陆阿里云，进入云服务器管理控制台，找到自己的实例
![输入图片说明]({{ site.baseurl }}/img/in-post/2017-11-27-ecs1-230423_4edfcc26_58701.png "1.png")
选择区域（购买时选的），启动实例，别忘了重置密码，重置后貌似要重启一次实例。这个密码就是root密码，妥善保存啊。
![输入图片说明]({{ site.baseurl }}/img/in-post/2017-11-27-ecs1-230814_db821222_58701.png "1.png")
修改安全组规则，购买的时候，可以选择默认安全组规则，打开常见的如80端口，但不包含8080端口，这个我要加上。点选安全组-配置规则
![输入图片说明]({{ site.baseurl }}/img/in-post/2017-11-27-ecs1-231223_6205c888_58701.png "1.png")
进入后，点击“快速创建规则”，设置范例如下，具体可以看帮助？，说的很清楚
![输入图片说明]({{ site.baseurl }}/img/in-post/2017-11-27-ecs1-231447_cdc664a2_58701.png "1.png")
配置xshell会话，协议选择ssh，端口22，登陆用户root，密码就是刚才上面设置的密码。实例暂时折腾完了。

## 安装vsftp
貌似如果选择CentOS镜像，默认就装好了vsftp，但是我买的这个入门型（最便宜的），镜像只能选择ubuntu16.04（哎，不爽），什么都没有，只能自己装。简单记录步骤如下：

- xshell远程登陆，输入apt-get install vsftpd, 报Unable to locate package错误，执行apt-get update，然后再执行install成功。
- /etc/vsftpd/vsftpd.conf 是主配置文件，核心配置文件。vim打开后修改，  
local_enable=YES  
write_enable=YES  
pam_service_name=ftp （这一条貌似是坑，原来是pam_service_name=vsftpd, 没太注意，结果登陆不上，网上一阵乱搜，改之。PAM是什么，至此也不是很理解）  
- 输入chmod o+w /var/ftp/pub/ ,更改/var/ftp/pub目录的权限 这个目录需要自己先建好，默认是没有的  
- 创建/etc/vsftpd/user_list //白名单，允许访问FTP服务器的用户列表，我在里面把root加进去（貌似这样是不好滴，应该建立单独的ftp用户，后续再说吧）。
- 常用操作
启动 service vsftpd start  
停止 sudo service vsftpd stop  
重启 sudo service vsftpd restart  
卸载 sudo apt-get purge vsftpd
查看ftp服务端口 netstat -antup | grep ftp
- 配置终端软件，我用的是xftp，注意“使用被动模式”勾选要去掉。至此ftp搭建完成

## 安装jdk
- 下载：去http://mirrors.linuxeye.com/jdk/ 下载吧，速度快，列表清晰，比去官网找半天方便多了。使用wget直接在云端下载吧，速度快。没必要本地下载完了，再上传上去。我装的是jdk1.8，下面分别是64和32位的下载命令  
wget http://mirrors.linuxeye.com/jdk/jdk-8u141-linux-x64.tar.gz  
wget http://mirrors.linuxeye.com/jdk/jdk-8u141-linux-i586.tar.gz  
下载完成后执行 tar xzf jdk-8u141-linux-i586.tar.gz -C /usr/java，解压，java目录需要手动创建。
- 设置环境变量：
  编辑 /etc/profile：vi /etc/profile。  
  按 i 键进入编辑模式。  
  在 /etc/profile 文件中添加以下信息：  
```
#set java environment
export JAVA_HOME=/usr/java/jdk1.8.0_141
export CLASSPATH=$JAVA_HOME/lib/tools.jar:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib
export PATH=$JAVA_HOME/bin:$PATH
```
 按 Esc 键退出编辑模式，输入 :wq 保存并关闭文件。加载环境变量：source /etc/profile。  
 输入java -version 查看 jdk 版本。当出现 jdk 版本信息时，表示 JDK 已经安装成功。











